!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jQuery")):"function"==typeof define&&define.amd?define("FlexTour",["jQuery"],t):"object"==typeof exports?exports.FlexTour=t(require("jQuery")):e.FlexTour=t(e.jQuery)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function r(e){if(W.isArray(e)&&e.length>0){x.currentTourId=e[0][Y.ID];for(var t=0;t<e.length;t++)o(e[t])}else o(e),x.currentTourId=e[Y.ID]}function o(e){var t=W.extend(!0,{},e);t=W.extend({},Y.TOUR_DEFAULT_SETTINGS,t);for(var n=t[Y.STEPS].length,r=0;r<n;r++){var o=t[Y.STEPS][r],T=o[Y.CONTENT];M.isValid(x.translation)&&x.translation.hasOwnProperty(T)&&(o[Y.CONTENT]=x.translation[T]),o[Y.TYPE]=o[Y.TYPE]||Y.DEFAULT_TYPE,o[Y.POSITION]=o[Y.POSITION]||Y.DEFAULT_POSITION,o[Y.NO_BUTTONS]=o[Y.NO_BUTTONS]||t[Y.NO_BUTTONS],o[Y.DELAY]=o[Y.DELAY]||t[Y.DELAY],o[Y.NO_BACK]=o[Y.NO_BACK]||t[Y.NO_BACK],o[Y.CAN_INTERACT]=o[Y.CAN_INTERACT]||o[Y.NEXT_STEP_TRIGGER]||o[Y.DND]||t[Y.CAN_INTERACT],o[Y.WAIT_INTERVALS]=o[Y.WAIT_INTERVALS]||t[Y.WAIT_INTERVALS],o[Y.RETRIES]=o[Y.RETRIES]||t[Y.RETRIES],o[Y.NEXT_BUTTON_CUS]=o[Y.NEXT_BUTTON_CUS]||t[Y.NEXT_BUTTON_CUS],o[Y.BACK_BUTTON_CUS]=o[Y.BACK_BUTTON_CUS]||t[Y.BACK_BUTTON_CUS],o[Y.SKIP_BUTTON_CUS]=o[Y.SKIP_BUTTON_CUS]||t[Y.SKIP_BUTTON_CUS],o[Y.DONE_BUTTON_CUS]=o[Y.DONE_BUTTON_CUS]||t[Y.DONE_BUTTON_CUS];var i=o[Y.NEXT_STEP_TRIGGER];i&&i===Y.CURRENT_TARGET&&(o[Y.NEXT_STEP_TRIGGER]=o[Y.TARGET]);var E=o[Y.FLASH_TARGET];E&&E===Y.CURRENT_TARGET&&(o[Y.FLASH_TARGET]=o[Y.TARGET]);var s=o[Y.BUTTONS_CUS]||t[Y.BUTTONS_CUS];if(M.isValid(s)){for(var a=0;a<s.length;a++){var u=s[a][Y.ONCLICK_NAME];x.actionsList.hasOwnProperty(u)&&(s[a][Y.ONCLICK_NAME]=x.actionsList[u])}o[Y.BUTTONS_CUS]=s}}x.toursMap[t[Y.ID]]=t}function T(e,t){var n=x.currentStepNumber;if(x.Component=new w(e,n+1),M.isValid(x.Component)){var r=!1,o=!1,T=!1,s=!1;(e[Y.NO_BUTTONS]||e[Y.TRANSITION])&&(s=!0);var a=x.currentTour[Y.STEPS].length;if(n<a-1&&(o=!0),e[Y.NEXT_STEP_TRIGGER]&&(T=!0),n>0&&!e[Y.NO_BACK]&&(r=!0),l(Y.BEFORE_STEP),x.running)x.Component.modifyComponents(s,r,o,T);else{x.Component.createComponents(s,r,o,T),x.running=!0,d(),A();var c=x.currentTour[Y.STYLES];M.isValid(c)&&M.getEleFromClassName(Y.TOUR_BUBBLE,!0).addClass(c)}M.isValid(e[Y.SKIP])&&M.getElementsAndAttachEvent(Y.SKIP_BUTTON_TRIGGER,Y.FLEX_CLICK,S),e[Y.TRANSITION]&&u(n+1,0)&&R(n+1),t&&(M.isValid(e[Y.NEXT_STEP_TRIGGER])&&E(e[Y.NEXT_STEP_TRIGGER]),M.isValid(e[Y.MODAL])&&h(),M.isValid(e[Y.SCROLL_LOCK])&&U(),i(),M.isDnDStep(e)&&D(e[Y.TARGET]),M.isValid(e[Y.MULTIPAGE])&&(b(),M.setKeyValuePairLS(Y.MULTIPAGE_KEY,!0),M.addEvent(W(window),x.HASH_CHANGE,function(){M.removeEvent(W(window),x.HASH_CHANGE),K(!1)}))),l(Y.AFTER_STEP)}else console.log("Target of step: "+JSON.stringify(e)+" is not found in the DOM in the current step."),K(!0),M.removeLSValue(Y.LOCALSTORAGE_KEY)}function i(){x.currentTour[Y.END_ON_OVERLAY_CLICK]&&M.getElementsAndAttachEvent(Y.OVERLAY_STYLE,Y.FLEX_CLICK,function(){K(!1)}),M.getElementsAndAttachEvent(Y.BACK_BUTTON_TRIGGER,Y.FLEX_CLICK,N),M.getElementsAndAttachEvent(Y.NEXT_BUTTON_TRIGGER,Y.FLEX_CLICK,p),M.getElementsAndAttachEvent(Y.DONE_BUTTON_TRIGGER,Y.FLEX_CLICK,function(){K(!0),M.removeLSValue(Y.LOCALSTORAGE_KEY)}),M.getElementsAndAttachEvent(Y.CLOSE_TOUR,Y.FLEX_CLICK,function(){K(!1)})}function E(e){var t=W(e);M.hasELement(t)&&M.addEvent(t,Y.FLEX_CLICK,p)}function s(){M.removeELementsAndAttachedEvent(Y.OVERLAY_STYLE,Y.FLEX_CLICK),M.removeELementsAndAttachedEvent(Y.BACK_BUTTON_TRIGGER,Y.FLEX_CLICK),M.removeELementsAndAttachedEvent(Y.NEXT_BUTTON_TRIGGER,Y.FLEX_CLICK),M.removeELementsAndAttachedEvent(Y.DONE_BUTTON_TRIGGER,Y.FLEX_CLICK),M.removeELementsAndAttachedEvent(Y.CLOSE_TOUR,Y.FLEX_CLICK)}function a(e){var t=W(e);M.hasELement(t)&&M.removeEvent(t,Y.FLEX_CLICK)}function u(e,t){var n=x.currentTour[Y.STEPS][e];if(!M.isValid(n))return!1;var r,o=n[Y.PREREQUISITES];if(!(M.isValid(o)&&t<o.length))return!0;var T=o[t].trim();if(!(T.indexOf(Y.WAIT)>-1)){if(T.indexOf(Y.PROCEED_INDICATOR)>-1){if(r=T.split(Y.PROCEED_INDICATOR)[1].trim(),!_(e,r)){var i=n[Y.SKIP];return e>=x.currentStepNumber?M.isValid(i)?O(i-1,0):O(e+1,0):O(e-1,0),!1}return!0}return!!c(T,e)&&u(e,++t)}r=T.split(Y.WAIT)[1].trim();var E=_(e,r);return E?(x.currentTour.hasOwnProperty(Y.RETRIES)&&(n[Y.RETRIES]=x.currentTour[Y.RETRIES]),u(e,++t)):n[Y.RETRIES]<=0?(x.currentTour.hasOwnProperty(Y.RETRIES)&&(n[Y.RETRIES]=x.currentTour[Y.RETRIES]),u(e,++t),E):(n[Y.RETRIES]--,void setTimeout(function(){O(e,t)},n[Y.WAIT_INTERVALS]))}function c(e,t){return"function"==typeof x.actionsList[e]&&x.actionsList[e].call(this,x.currentTour[Y.STEPS][t])}function l(e){"function"==typeof x.actionsList[e]&&x.actionsList[e].call(this)}function _(e,t){var n=t.split(Y.COLON),r=n[0],o=!0;if(!(n.length>1))return c(r,e);var T=n[1].split(Y.COMMA),i=T.indexOf(Y.CURRENT_TARGET);return i!==-1&&(T[i]=x.currentTour[Y.STEPS][e][Y.TARGET]),r===Y.IS_VISIBLE?o=o&&M.isVisible(T):r===Y.DOES_EXIST?o=o&&M.doesExist(T):"function"==typeof x.actionsList[r]&&(o=o&&x.actionsList[r].apply(this,T)),o}function O(e,t){e>=x.currentTour[Y.STEPS].length&&K(!0),u(e,t)&&R(e)}function S(e){M.noDefault(e),B(),M.removeELementsAndAttachedEvent(Y.SKIP_BUTTON_TRIGGER,Y.FLEX_CLICK);var t=x.currentTour[Y.STEPS][x.currentStepNumber][Y.SKIP];M.isValid(t)&&O(t-1,0)}function N(e){M.noDefault(e),B(),O(x.currentStepNumber-1,0)}function p(e){M.noDefault(e),B(),O(x.currentStepNumber+1,0)}function R(e){function t(e){x.currentStepNumber=e,T(x.currentTour[Y.STEPS][e],!0)}var n=x.currentTour[Y.STEPS][e][Y.DELAY];M.isValid(n)?setTimeout(t.bind(this,e),n):t(e)}function d(){M.addEvent(W(window),Y.FLEX_RESIZE,M.debounce(f,500,!1))}function f(){s(),x.Component.removeOverlays(),T(x.currentTour[Y.STEPS][x.currentStepNumber],!1),i()}function C(){T(x.currentTour[Y.STEPS][x.currentStepNumber],!1)}function L(){M.removeEvent(W(window),Y.FLEX_RESIZE)}function A(){M.addEvent(W(window),Y.KEY_UP,I)}function I(e){27===e.keyCode&&M.isValid(x.currentTour[Y.END_ON_ESC])&&K(!1)}function m(){M.removeEvent(W(window),Y.KEY_UP)}function h(){M.addEvent(W(window),Y.SCROLL,M.debounce(C,200,!1))}function P(){M.removeEvent(W(window),Y.SCROLL)}function B(){var e=x.currentTour[Y.STEPS][x.currentStepNumber];if(M.isValid(e)&&(M.isValid(e[Y.NEXT_STEP_TRIGGER])&&a(e[Y.NEXT_STEP_TRIGGER]),e[Y.MODAL]&&P(),s(),M.isValid(e[Y.SCROLL_LOCK])&&v(),M.isValid(e[Y.BUTTONS_CUS])))for(var t=e[Y.BUTTONS_CUS],n=0;n<t.length;n++)M.removeEvent(M.getEleFromClassName(t[n][Y.BUTTON_STYLE],!0),Y.FLEX_CLICK)}function U(){var e=W(window).scrollTop(),t=W(window).scrollLeft();M.addEvent(W(window),Y.SCROLL,function(n){n.preventDefault(),W(window).scrollTop(e).scrollLeft(t)}),M.debounce(C,10,!0)}function v(){M.removeEvent(W(window),Y.SCROLL)}function D(e){M.addEvent(W(e),Y.DRAG_START,X),M.addEvent(W(e),Y.DRAG_END,function(){g(e)})}function g(e){G(e),u(x.currentStepNumber+1,0)?R(x.currentStepNumber+1):T(x.currentTour[Y.STEPS][x.currentStepNumber],!0)}function G(e){M.removeEvent(W(e),Y.DRAG_START),M.removeEvent(W(e),Y.DRAG_END)}function X(){L(),m(),B(),M.isValid(x.Component)&&x.Component.removeComponents(),x.running=!1}function K(e){!x.currentTour[Y.PAUSE_ON_EXIT]||M.isValid(e)&&e||(b(),M.setKeyValuePairLS(Y.PAUSED_KEY,!0)),X(),x.currentStepNumber=0,l(Y.ON_EXIT)}function F(){var e=x.currentTour[Y.STEPS];M.isValid(e)&&O(x.currentStepNumber,0)}function V(){var e=M.getKeyValuePairLS(Y.STEP_STATUS);W.isEmptyObject(e)||(x.currentTourId=e[Y.PAUSED_TOUR],x.currentTour=W.extend(!0,{},x.toursMap[x.currentTourId]),x.currentStepNumber=e[Y.PAUSED_STEP],M.removeKeyValuePairLS(Y.STEP_STATUS))}function b(){var e={pausedTour:x.currentTourId,pausedStep:x.currentStepNumber};M.setKeyValuePairLS(Y.STEP_STATUS,e)}function y(){var e=x.currentTour[Y.STEPS];if(M.isValid(e)){var t=e[x.currentStepNumber][Y.TARGET];if(!M.hasELement(W(t))||!M.isVisible(t))for(--x.currentStepNumber;x.currentStepNumber>-1&&!M.checkFlag(e[x.currentStepNumber][Y.SAVE_POINT]);)--x.currentStepNumber;O(x.currentStepNumber,0)}}function x(e,t,n){x.toursMap={},x.currentTourId="",x.currentStepNumber=0,x.currentTour={},x.actionsList=t||{},x.translation=n||{},x.running=!1,r(e)}var w=n(4),Y=n(1),M=n(3),W=n(2);x.prototype.run=function(){if(!W.isEmptyObject(x.toursMap)){l(Y.ON_START);var e=M.getKeyValuePairLS(Y.MULTIPAGE),t=M.getKeyValuePairLS(Y.PAUSED_KEY);M.checkFlag(t)?(V(),M.removeKeyValuePairLS(Y.PAUSED_KEY),M.removeKeyValuePairLS(Y.MULTIPAGE_KEY),y()):M.checkFlag(e)?(V(),M.removeKeyValuePairLS(Y.MULTIPAGE_KEY),++x.currentStepNumber,F()):(x.currentTour=W.extend(!0,{},x.toursMap[x.currentTourId]),x.currentStepNumber=0,F())}},x.prototype.exit=function(){K(!1)},x.prototype.pause=function(){b(),M.setKeyValuePairLS(Y.PAUSED_KEY,!0),this.exit()},x.prototype.resume=function(){V(),M.removeKeyValuePairLS(Y.PAUSED_KEY),y()},e.exports=x},function(e,t){e.exports={CLASS:".",COLON:":",COMMA:",",WAIT:"?",PROCEED_INDICATOR:"!",CURRENT_TARGET:"@target@",IS_VISIBLE:"isVisible",DOES_EXIST:"doesExist",OVERLAY_STYLE:"flextour-overlay-styles",FLEXTOUR:"flextour",TARGET_BORDER:"flextour-target-border",FLASH_BORDER:"flextour-flash-border",TARGET_INTERACTABLE:"interactable",TOUR_BUBBLE:"flextour-tour-bubble",ARROW_LOCATION:"arrow-location",HOLLOW_ARROW:"inner-arrow",BUBBLE_CONTENT:"flextour-content",BUBBLE_CONTENT_BODY:"flextour-content-body",FLOAT_STYLE:"flextour-float-bubble",BUBBLE_TITLE:"flextour-bubble-title",ICON_STYLE:"icon-style",ICON_REGEXP:"flextour-icon",ACTION_ICON:"flextour-icon-action",DEFAULT_ICON:"flextour-icon-info",LOADING_ICON:"flextour-icon-loading",NUMBER_ICON:"flextour-icon-number",CLOSE_TOUR:"flextour-close",BUTTON_GROUP:"flextour-button-group",SKIP_BUTTON:"flextour-skip-button",BACK_BUTTON:"flextour-back-button",NEXT_BUTTON:"flextour-next-button",SKIP_BUTTON_TRIGGER:"flextour-skip-trigger",BACK_BUTTON_TRIGGER:"flextour-back-trigger",NEXT_BUTTON_TRIGGER:"flextour-next-trigger",DONE_BUTTON_TRIGGER:"flextour-done-trigger",FLEX_CLICK:"click.flextour",FLEX_RESIZE:"resize.flextour",KEY_UP:"keyup.flextour",SCROLL:"scroll.flextour",DRAG_START:"dragstart.flextour",DRAG_END:"dragend.flextour",HASH_CHANGE:"hashchange.flextour",LOCALSTORAGE_KEY:"flextour.storage",MULTIPAGE_KEY:"multipage",CURRENT_TOUR:"currentTour",CURRENT_STEP:"currentStep",PAUSED_KEY:"paused",STEP_STATUS:"stepStatus",PAUSED_TOUR:"pausedTour",PAUSED_STEP:"pausedStep",TOUR_DEFAULT_SETTINGS:{transition:{},canInteract:!1,noButtons:!1,noBack:!1,noSkip:!1,endOnOverlayClick:!0,endOnEsc:!0,pauseOnExit:!1},ID:"id",TITLE:"title",STEPS:"steps",NO_BUTTONS:"noButtons",NO_BACK:"noBack",NO_SKIP:"noSkip",CAN_INTERACT:"canInteract",TYPE:"type",CONTENT:"content",PREREQUISITES:"prerequisites",TARGET:"target",POSITION:"position",NEXT_STEP_TRIGGER:"nextStepTrigger",FLASH_TARGET:"flashTarget",WAIT_INTERVALS:"waitIntervals",RETRIES:"retries",END_ON_ESC:"endOnEsc",END_ON_OVERLAY_CLICK:"endOnOverlayClick",DELAY:"delay",TRANSITION:"transition",SKIP:"skip",MODAL:"modal",SCROLL_LOCK:"scrollLock",STYLES:"styles",NEXT_BUTTON_CUS:"nextButton",BACK_BUTTON_CUS:"backButton",SKIP_BUTTON_CUS:"skipButton",DONE_BUTTON_CUS:"doneButton",BUTTONS_CUS:"buttons",BUTTON_NAME:"name",BUTTON_STYLE:"style",ONCLICK_NAME:"onclick",MULTIPAGE:"multipage",SAVE_POINT:"savePoint",PAUSE_ON_EXIT:"pauseOnExit",DND:"dragAndDrop",DEFAULT_TYPE:"info",ACTION_TYPE:"action",NUMBER_TYPE:"number",DEFAULT_POSITION:"bottom",TIMES:"&times;",BORDER_WIDTH:1,FLASH_BORDER_WIDTH:1,OVERLAP_HEIGHT:1,ARROW_SIZE:20,PX:"px",TOP:"top",RIGHT:"right",LEFT:"left",BOTTOM:"bottom",FLOAT:"float",SKIP_TEXT:"Skip",NEXT_TEXT:"Next",BACK_TEXT:"Back",DONE_TEXT:"Done",DIV_COMP:"<div></div>",SPAN_COMP:"<span></span>",BUTTON_COMP:"<button></button>",A_COMP:"<a></a>",TOUR:"tour",ON_EXIT:"onExit",ON_START:"onStart",BEFORE_STEP:"beforeStepRender",AFTER_STEP:"afterStepRender"}},function(t,n){t.exports=e},function(e,t,n){var r=n(1),o=n(2);e.exports={isVisible:function(e){for(var t=!0,n=this.convertToArray(e),r=0;r<n.length;r++){var T=o(n[r]);if(!this.hasELement(T))return!1;t=t&&T.is(":visible")}return t},doesExist:function(e){for(var t=!0,n=this.convertToArray(e),r=0;r<n.length;r++)t=t&&this.hasELement(o(n[r]));return t},convertToArray:function(e){return o.isArray(e)?e:[e]},isValid:function(e){return o.isArray(e)?e.length>0:null!=e&&"undefined"!=typeof e},hasELement:function(e){return e.length>0},addEvent:function(e,t,n){this.isValid(e)&&e.on(t,n)},removeEvent:function(e,t,n){this.isValid(e)&&e.off(t,n)},noDefault:function(e){e.preventDefault(),e.stopPropagation()},getClassName:function(e){return r.CLASS+e},getEleFromClassName:function(e,t){var n=o(this.getClassName(e));return t?n:n?n[0]:n},getElesFromClassName:function(e){return o(this.getClassName(e))},isStepWithTarget:function(e){return e.hasOwnProperty(r.TARGET)&&e.hasOwnProperty(r.CONTENT)},isFloatStep:function(e){return e[r.POSITION]===r.FLOAT&&e.hasOwnProperty(r.CONTENT)},isDnDStep:function(e){return e[r.DND]&&e.hasOwnProperty(r.TARGET)},getElementsAndAttachEvent:function(e,t,n){var r=this.getElesFromClassName(e);this.addEvent(r,t,n)},removeELementsAndAttachedEvent:function(e,t,n){var r=this.getElesFromClassName(e);this.removeEvent(r,t,n)},getFullWindowWidth:function(){return Math.max(o(document).width(),o(window).width())},getFullWindowHeight:function(){return Math.max(o(document).height(),o(window).innerHeight())},debounce:function(e,t,n){var r;return function(){var o=this,T=arguments,i=function(){r=null,n||e.apply(o,T)},E=n&&!r;clearTimeout(r),r=setTimeout(i,t),E&&e.apply(o,T)}},smoothScroll:function(e,t){var n=e.top-40;t===r.TOP&&(n-=this.getEleFromClassName(r.TOUR_BUBBLE,!0).height()),o("html, body").animate({scrollTop:n},300)},setKeyValuePairLS:function(e,t){try{var n=JSON.parse(localStorage.getItem(r.LOCALSTORAGE_KEY));this.isValid(n)||(n={}),n[e]=t,localStorage.setItem(r.LOCALSTORAGE_KEY,JSON.stringify(n))}catch(o){console.log("Multipage feature cannot be supported in this browser version")}},getKeyValuePairLS:function(e){try{return JSON.parse(localStorage.getItem(r.LOCALSTORAGE_KEY))[e]}catch(t){return{}}},removeKeyValuePairLS:function(e){try{var t=JSON.parse(localStorage.getItem(r.LOCALSTORAGE_KEY));delete t[e],localStorage.setItem(r.LOCALSTORAGE_KEY,JSON.stringify(t))}catch(n){}},removeLSValue:function(e){try{localStorage.removeItem(e)}catch(t){console.log("The localstorage might not contain the given key")}},checkFlag:function(e){return("object"!=typeof e||!o.isEmptyObject(e))&&e}}},function(e,t,n){function r(e,t){if(r.stepDescription=V.extend({},e),r.stepNumber=t,r.ui=V(K.DIV_COMP),r.ui.addClass(K.FLEXTOUR),F.isStepWithTarget(e)){var n=V(e[K.TARGET]);if(!F.hasELement(n))return;var o={};o.top=n.offset().top,o.left=n.offset().left,o.width=n.outerWidth(),o.height=n.outerHeight(),o.right=o.left+o.width,o.bottom=o.top+o.height,r.rect=o}}function o(){return{width:F.getFullWindowWidth()+K.PX,height:r.rect.top+K.PX,top:0,left:0}}function T(){return{width:F.getFullWindowWidth()+K.PX,height:F.getFullWindowHeight()-r.rect.bottom+K.PX,top:r.rect.bottom+K.PX,left:0}}function i(){return{width:r.rect.left+K.PX,height:r.rect.height+K.PX,top:r.rect.top+K.PX,left:0}}function E(){return{width:F.getFullWindowWidth()-r.rect.right+K.PX,height:r.rect.height+K.PX,top:r.rect.top+K.PX,left:r.rect.right+K.PX}}function s(e){if(!(e.left<0||e.top<0)){var t=V(K.DIV_COMP,{"class":K.OVERLAY_STYLE,width:e.width,height:e.height});return t.css({top:e.top,left:e.left}),t}}function a(){s(o()).appendTo(r.ui),s(E()).appendTo(r.ui),s(T()).appendTo(r.ui),s(i()).appendTo(r.ui)}function u(e,t){V(e).css({width:t.width,height:t.height,top:t.top,left:t.left})}function c(){var e=F.getElesFromClassName(K.OVERLAY_STYLE);F.hasELement(e)&&4===e.length?(u(e[0],o()),u(e[1],E()),u(e[2],T()),u(e[3],i())):(e.remove(),a())}function l(){var e=V(K.DIV_COMP,{"class":K.OVERLAY_STYLE});e(s({width:F.getFullWindowWidth()+K.PX,height:F.getFullWindowHeight()+K.PX,top:0,left:0})),e.appendTo(r.ui)}function _(){var e=F.getElesFromClassName(K.OVERLAY_STYLE);if(F.hasELement(e)&&1!==e.length){e.remove();var t=s({width:F.getFullWindowWidth()+K.PX,height:F.getFullWindowHeight()+K.PX,top:0,left:0});t.appendTo(r.ui)}}function O(e,t,n,o){var T=V(K.DIV_COMP,{"class":K.TOUR_BUBBLE}),i=V(K.DIV_COMP,{"class":K.ICON_STYLE+" "+I()});F.isValid(r.stepNumber)&&r.stepDescription[K.TYPE]===K.NUMBER_TYPE&&i.html(r.stepNumber),i.appendTo(T);var E=V(K.DIV_COMP,{"class":K.BUBBLE_CONTENT});F.isValid(r.stepDescription[K.TITLE])&&V(K.DIV_COMP,{"class":K.BUBBLE_TITLE,html:r.stepDescription[K.TITLE]}).appendTo(E),V(K.DIV_COMP,{"class":K.BUBBLE_CONTENT_BODY,html:r.stepDescription[K.CONTENT]}).appendTo(E),T.append(E);var s=V(K.DIV_COMP,{"class":K.BUTTON_GROUP});if(T.append(s),F.isValid(r.stepDescription[K.BUTTONS_CUS]))for(var a=r.stepDescription[K.BUTTONS_CUS],u=0;u<a.length;u++)S(a[u],s);else e||(F.isValid(r.stepDescription[K.SKIP])&&N(s).appendTo(s),R(t).appendTo(s),n?f(o).appendTo(s):L(o).appendTo(s));V(K.A_COMP,{"class":K.CLOSE_TOUR,html:K.TIMES}).appendTo(T),r.ui.append(T)}function S(e,t){var n=V(K.BUTTON_COMP,{"class":e[K.BUTTON_STYLE],text:e[K.BUTTON_NAME]}),r=e[K.ONCLICK_NAME];if(F.isValid(r)&&"function"==typeof r)F.addEvent(n,K.FLEX_CLICK,r);else if(F.isValid(r)&&"string"==typeof r)switch(r){case K.SKIP_TEXT:n.addClass(K.SKIP_BUTTON_TRIGGER);break;case K.BACK_TEXT:n.addClass(K.BACK_BUTTON_TRIGGER);break;case K.NEXT_TEXT:n.addClass(K.NEXT_BUTTON_TRIGGER);break;case K.DONE_TEXT:n.addClass(K.DONE_BUTTON_TRIGGER)}n.appendTo(t)}function N(){return V(K.BUTTON_COMP,{"class":K.SKIP_BUTTON+" "+K.SKIP_BUTTON_TRIGGER,text:p()})}function p(){return r.stepDescription[K.SKIP_BUTTON_CUS]||K.SKIP_TEXT}function R(e){return V(K.BUTTON_COMP,{"class":K.BACK_BUTTON+" "+K.BACK_BUTTON_TRIGGER,text:d(),disabled:!e})}function d(){return r.stepDescription[K.BACK_BUTTON_CUS]||K.BACK_TEXT}function f(e){return V(K.BUTTON_COMP,{"class":K.NEXT_BUTTON+" "+K.NEXT_BUTTON_TRIGGER,text:C(),disabled:e})}function C(){return r.stepDescription[K.NEXT_BUTTON_CUS]||K.NEXT_TEXT}function L(e){return V(K.BUTTON_COMP,{"class":K.NEXT_BUTTON+" "+K.DONE_BUTTON_TRIGGER,text:A(),disabled:e})}function A(){return r.stepDescription[K.DONE_BUTTON_CUS]||K.DONE_TEXT}function I(){var e=r.stepDescription[K.TYPE];return r.stepDescription[K.TRANSITION]?K.LOADING_ICON:e===K.ACTION_TYPE?K.ACTION_ICON:e===K.NUMBER_TYPE?K.NUMBER_ICON:e===K.DEFAULT_TYPE?K.DEFAULT_ICON:""}function m(e,t,n,o){var T=I(),i=F.getEleFromClassName(K.ICON_STYLE,!0);if(!i.hasClass(T)){var E=i.attr("class");E.length>0&&(E=E.split(/\s+/g)),V.each(E,function(e,t){t.indexOf(K.ICON_REGEXP)>-1&&i.removeClass(t)}),i.addClass(T)}F.isValid(r.stepNumber)&&r.stepDescription[K.TYPE]===K.NUMBER_TYPE?i.html(r.stepNumber):i.html("");var s=F.getEleFromClassName(K.BUBBLE_CONTENT,!0),a=F.getEleFromClassName(K.BUBBLE_TITLE,!0);F.isValid(r.stepDescription[K.TITLE])?F.hasELement(a)?a.html(r.stepDescription[K.TITLE]):V(K.DIV_COMP,{"class":K.BUBBLE_TITLE,html:r.stepDescription[K.TITLE]}).prependTo(s):F.hasELement(a)&&a.remove();var u=F.getEleFromClassName(K.BUBBLE_CONTENT_BODY,!0);u.html(r.stepDescription[K.CONTENT]);var c=F.getEleFromClassName(K.TOUR_BUBBLE,!0),l=F.getEleFromClassName(K.BUTTON_GROUP,!0);if(e)F.hasELement(l)&&l.remove();else if(F.isValid(r.stepDescription[K.BUTTONS_CUS])){F.hasELement(l)&&l.remove(),l=V(K.DIV_COMP,{"class":K.BUTTON_GROUP}),c.append(l);for(var _=r.stepDescription[K.BUTTONS_CUS],O=0;O<_.length;O++)S(_[O],l)}else{F.hasELement(l)||(l=V(K.DIV_COMP,{"class":K.BUTTON_GROUP}),c.append(l));var m=F.getEleFromClassName(K.NEXT_BUTTON,!0);n?F.hasELement(m)?(m.text(C()),m.prop("disabled",o)):m=f(o).appendTo(l):F.hasELement(m)?(m.prop("disabled",o),m.text(A())):m=L(o).appendTo(l);var h=F.getEleFromClassName(K.BACK_BUTTON,!0);F.hasELement(h)?(h.prop("disabled",!t),h.text(d())):(h=R(t),F.hasELement(m)&&h.insertBefore(m));var P=r.stepDescription[K.SKIP],B=F.getEleFromClassName(K.SKIP_BUTTON,!0);F.isValid(P)&&!F.isValid(r.stepDescription[K.NO_SKIP])?(F.hasELement(B)||(B=N().prependTo(l)),B.text(p())):F.hasELement(B)&&B.remove()}}function h(){var e=r.rect,t=F.getEleFromClassName(K.TOUR_BUBBLE,!0);if(F.hasELement(t)){var n=t[0].getBoundingClientRect(),o=n.height/2,T=n.width/2,i=r.rect.height/2,E=r.rect.width/2,s=V(K.SPAN_COMP,{"class":K.ARROW_LOCATION});switch(r.stepDescription[K.POSITION]){case K.TOP:s.addClass(K.TOP),t.css({top:r.rect.top-n.height-K.ARROW_SIZE+4*K.BORDER_WIDTH+K.PX}),t.css({left:r.rect.left+E-T+K.PX});break;case K.RIGHT:s.addClass(K.RIGHT),t.css({top:r.rect.top+i-o+K.PX}),t.css({left:e.right+K.ARROW_SIZE-4*K.BORDER_WIDTH+K.PX});break;case K.LEFT:s.addClass(K.LEFT),t.css({top:r.rect.top+i-o+K.PX}),t.css({left:r.rect.left-n.width-K.ARROW_SIZE+4*K.BORDER_WIDTH+K.PX});break;default:s.addClass(K.BOTTOM),t.css({top:e.bottom+K.ARROW_SIZE-4*K.BORDER_WIDTH+K.PX}),t.css({left:r.rect.left+E-T+K.PX})}V(K.SPAN_COMP,{"class":K.HOLLOW_ARROW}).appendTo(s),t.append(s)}}function P(){var e=F.getEleFromClassName(K.TOUR_BUBBLE,!0);F.getEleFromClassName(K.ARROW_LOCATION,!0).remove(),e.removeClass(K.FLOAT_STYLE),h()}function B(){var e=F.getEleFromClassName(K.TOUR_BUBBLE,!0);e.addClass(K.FLOAT_STYLE)}function U(){var e=F.getEleFromClassName(K.TOUR_BUBBLE,!0);e.addClass(K.FLOAT_STYLE);var t=F.getEleFromClassName(K.ARROW_LOCATION,!0);F.hasELement(t)&&(t.remove(),e.css({top:"",left:""}))}function v(){if(F.isValid(r.rect)){var e=V(K.DIV_COMP,{"class":K.TARGET_BORDER});e.css({width:r.rect.width+K.PX,height:r.rect.height+K.PX,top:r.rect.top+K.PX,left:r.rect.left+K.PX}),r.stepDescription[K.CAN_INTERACT]&&e.addClass(K.TARGET_INTERACTABLE),r.ui.append(e)}}function D(){if(F.isValid(r.rect)){var e=F.getEleFromClassName(K.TARGET_BORDER,!0);e.css({width:r.rect.width+K.PX,height:r.rect.height+K.PX,top:r.rect.top+K.PX,left:r.rect.left+K.PX}),r.stepDescription[K.CAN_INTERACT]?e.addClass(K.TARGET_INTERACTABLE):e.removeClass(K.TARGET_INTERACTABLE)}}function g(){var e=r.stepDescription[K.MODAL];F.isValid(e)||F.smoothScroll(r.rect,r.stepDescription.position)}function G(){var e=r.stepDescription[K.FLASH_TARGET];if(F.isValid(e)){var t=V(e),n=V(K.DIV_COMP,{"class":K.FLASH_BORDER});n.css({width:t.outerWidth()+2*K.BORDER_WIDTH+K.PX,height:t.outerHeight()+2*K.BORDER_WIDTH+K.PX,top:t.offset().top-K.FLASH_BORDER_WIDTH+K.PX,left:t.offset().left-K.FLASH_BORDER_WIDTH+K.PX}),r.ui.append(n)}}function X(){var e=r.stepDescription[K.FLASH_TARGET],t=F.getEleFromClassName(K.FLASH_BORDER,!0);if(F.isValid(e))if(F.hasELement(t)){var n=V(e);t.css({width:n.outerWidth()+2*K.BORDER_WIDTH+K.PX,height:n.outerHeight()+2*K.BORDER_WIDTH+K.PX,top:n.offset().top-K.FLASH_BORDER_WIDTH+K.PX,left:n.offset().left-K.FLASH_BORDER_WIDTH+K.PX})}else G();else F.hasELement(t)&&t.remove()}var K=n(1),F=n(3),V=n(2);r.prototype.createComponents=function(e,t,n,o){F.isFloatStep(r.stepDescription)?(O(e,t,n,o),l(),V(document.body).append(r.ui),B()):(v(),G(),O(e,t,n,o),a(),V(document.body).append(r.ui),h()),r.stepDescription[K.SCROLL_LOCK]||g()},r.prototype.modifyComponents=function(e,t,n,o){r.ui=F.getEleFromClassName(K.FLEXTOUR,!0),F.isFloatStep(r.stepDescription)?(m(e,t,n,o),U(),_()):(D(),X(),m(e,t,n,o),c(),P()),r.stepDescription[K.SCROLL_LOCK]||g()},r.prototype.removeComponents=function(){r.ui.remove()},r.prototype.removeOverlays=function(){var e=F.getEleFromClassName(K.OVERLAY_STYLE,!0);F.hasELement(e)&&e.remove()},e.exports=r}])});